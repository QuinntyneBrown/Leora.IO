import {Component} from "@angular/core";
import {{{ entityNamePascalCase }}sService} from "./{{ entityNameSnakeCase }}s.service";
import {Router,ActivatedRoute} from "@angular/router";
import {guid} from "../shared/utilities/guid";
import {CorrelationIdsList} from "../shared/services/correlation-ids-list";

@Component({
    templateUrl: "./{{ entityNameSnakeCase }}-edit-page.component.html",
    styleUrls: ["./{{ entityNameSnakeCase }}-edit-page.component.css"],
    selector: "ce-{{ entityNameSnakeCase }}-edit-page"
})
export class {{ entityNamePascalCase }}EditPageComponent {
    constructor(private _{{ entityNameCamelCase }}sService: {{ entityNamePascalCase }}sService,
        private _router: Router,
        private _activatedRoute: ActivatedRoute,
        private _correlationIdsList: CorrelationIdsList
    ) { }

    public async ngOnInit() {
        if (this._activatedRoute.snapshot.params["id"]) {            
            this.{{ entityNameCamelCase }} = (await this._{{ entityNameCamelCase }}sService.getById({ id: this._activatedRoute.snapshot.params["id"] }).toPromise()).{{ entityNameCamelCase }};
        }
    }

    public tryToSave($event) {
        const correlationId = this._correlationIdsList.newId();
        this._{{ entityNameCamelCase }}sService.addOrUpdate({ {{ entityNameCamelCase }}: $event.detail.{{ entityNameCamelCase }}, correlationId }).subscribe();
        this._router.navigateByUrl("/{{ entityNameCamelCase }}s");
    }

    public {{ entityNameCamelCase }} = {};
}
